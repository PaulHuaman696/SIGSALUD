<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <title>Doctores - <%= especialidad %>
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/styles.css" />
</head>

<body>
  <%- include('partials/header') %>
    <h1 class="page-title">Doctores</h1>
    <p class="page-subtitle">Selecciona el doctor de su preferencia para agendar tu cita</p>

    <div class="max-w-[480px] mx-auto my-[20px] px-[15px] py-[10px]">
      <div class="flex justify-between items-center mb-[15px]">
        <label class="font-semibold text-[#00345b]"><input type="checkbox" id="filterDisponibles" onchange="filtrarDisponibles()" /> Mostrar solo disponibles
          hoy</label>
      </div>

      <div class="flex flex-col gap-[20px]" id="listaDoctores">
        <% doctores.forEach(doctor=> { %>
          <div class="bg-white rounded-[12px] shadow-[0_4px_10px_rgba(0,0,0,0.1)] p-[15px] flex gap-[15px] items-center" data-disponible="<%= doctor.disponibleHoy %>">
            <div class="w-[80px] h-[80px] rounded-full bg-[#ddd] bg-cover bg-center flex-shrink-0" style="background-image: url('<%= doctor.fotoUrl %>')"></div>
            <div class="flex-grow">
              <div class="font-bold text-[1.2rem] text-[#00345b] mb-[4px]">
                <%= doctor.nombre %>
              </div>
              <div class="text-[0.9rem] text-[#555] mb-[6px]">
                <%= doctor.descripcion %>
              </div>
              <div class="text-[#f4c150] mb-[6px]">
                <% for(let i=0; i<5; i++) { %>
                  <% if(i < doctor.calificacion) { %>
                    ★
                    <% } else { %>
                      ☆
                      <% } %>
                        <% } %>
              </div>
            </div>
            <div class="flex flex-col gap-[8px]">
              <div class="cursor-pointer text-[1.5rem] text-[#e74c3c] select-none" onclick="toggleFavorito(this)">❤</div>
              <button class="bg-[#4bb2a7] text-white border-none px-[15px] py-[8px] rounded-[8px] font-bold cursor-pointer transition-colors duration-300 hover:bg-[#3a8e82]"
                onclick="location.href='/seleccionar-cita/<%= doctor.id %>'">Seleccionar</button>
            </div>
          </div>
          <% }) %>
      </div>
    </div>
    <script>
      function filtrarDisponibles() {
        const checkbox = document.getElementById('filterDisponibles');
        const lista = document.getElementById('listaDoctores');
        const cards = lista.querySelectorAll('.doctor-card');
        cards.forEach(card => {
          const disponible = card.getAttribute('data-disponible') === 'true';
          card.style.display = (!checkbox.checked || disponible) ? 'flex' : 'none';
        });
      }

      function toggleFavorito(el) {
        if (el.style.color === 'red' || el.style.color === 'rgb(255, 0, 0)') {
          el.style.color = '#e74c3c'; // rojo original
        } else {
          el.style.color = 'red';
        }
      }
    </script>
</body>

</html>
